# Auditor Planning Mode - 2026-02-06

**Generated:** 2026-02-06 11:53:27
**Tasks:** 5

---

Now I have a comprehensive view of the system. Let me generate the task queue based on my findings.

Based on my analysis of the LifeOS codebase, here are **5 concrete, executable tasks** for the Coder:

---

### TASK-PLAN.1: Add Offline Mode Indicator Badge to Dashboard
Priority: P1
Owner: coder
Status: READY
Lane: safe_auto

**Objective:** Show a visual badge on TodayView when the device is offline or when the OfflineQueue has pending items, so users know their data is queued for sync.

**Files to Touch:**
- `ios/Nexus/Views/Dashboard/Cards/TodayBannersView.swift`
- `ios/Nexus/Services/OfflineQueue.swift` (add `@Published var pendingCount: Int`)

**Verification:**
- [ ] Toggle airplane mode on device → banner appears showing "Offline - X items queued"
- [ ] Queue an item while offline → count updates in real-time
- [ ] Go online → banner disappears after queue processes

**Exit Criteria:**
- [ ] `grep -c 'pendingCount\|offlineIndicator' ios/Nexus/Views/Dashboard/Cards/TodayBannersView.swift` returns ≥2
- [ ] `xcodebuild -scheme Nexus build` succeeds

**Done Means:** User sees offline status and queue depth without opening Settings.

---

### TASK-PLAN.2: Add Quick Actions Menu (3D Touch / Long-Press)
Priority: P1
Owner: coder
Status: READY
Lane: safe_auto

**Objective:** Enable home screen quick actions (long-press app icon) for Log Water, Log Mood, Start Fast — instant access without opening app.

**Files to Touch:**
- `ios/Nexus/NexusApp.swift` (add UIApplicationShortcutItem handling)
- `ios/Nexus/Info.plist` (add UIApplicationShortcutItems array)

**Verification:**
- [ ] Long-press Nexus app icon on home screen → shows 3 quick actions
- [ ] Tap "Log Water" → app opens and triggers water log flow
- [ ] Tap "Start Fast" → app opens and triggers fasting start

**Exit Criteria:**
- [ ] `grep -c 'UIApplicationShortcutItem\|performActionFor' ios/Nexus/NexusApp.swift` returns ≥2
- [ ] `xcodebuild -scheme Nexus build` succeeds

**Done Means:** User can log water, mood, or start fasting from home screen without opening app.

---

### TASK-PLAN.3: Reactivate GitHub Sync Workflow
Priority: P1
Owner: coder
Status: READY
Lane: needs_approval

**Objective:** GitHub feed shows `status: ok` but hasn't synced since Jan 27 because the n8n workflow is inactive. Reactivate it to resume GitHub activity tracking.

**Files to Touch:**
- `backend/n8n-workflows/github-sync.json` (set `"active": true`)

**Verification:**
- [ ] After n8n import: `curl -s http://nexus:5678/webhook/github-sync-status` returns active workflow
- [ ] `ssh nexus "docker exec nexus-db psql -U nexus -d nexus -c \"SELECT MAX(created_at) FROM raw.github_events;\""` shows recent timestamp (within 6h of activation)

**Exit Criteria:**
- [ ] `grep '"active": true' backend/n8n-workflows/github-sync.json` succeeds
- [ ] GitHub events appear in `raw.github_events` after next scheduled run

**Done Means:** GitHub activity syncs every 6 hours, dashboard shows fresh data.

**Note:** Requires n8n workflow import and activation. User must have valid GitHub token configured.

---

### TASK-PLAN.4: Add Budget Alert Push Notifications
Priority: P2
Owner: coder
Status: READY
Lane: safe_auto

**Objective:** Send a local push notification when daily spending exceeds 80% of any active budget threshold, alerting the user proactively.

**Files to Touch:**
- `ios/Nexus/Services/NotificationManager.swift` (new file, ~60 LOC)
- `ios/Nexus/Services/SyncCoordinator.swift` (call notification check after dashboard refresh)
- `ios/Nexus/NexusApp.swift` (request notification permission on first launch)

**Verification:**
- [ ] Set a test budget (e.g., Food: 100 AED), log expenses exceeding 80 AED
- [ ] App backgrounded → notification appears: "Budget Alert: Food at 85%"
- [ ] Notification taps open Finance tab

**Exit Criteria:**
- [ ] `ls ios/Nexus/Services/NotificationManager.swift` succeeds
- [ ] `grep -c 'UNUserNotificationCenter\|budgetAlert' ios/Nexus/Services/NotificationManager.swift` returns ≥2
- [ ] `xcodebuild -scheme Nexus build` succeeds

**Done Means:** User receives proactive budget warnings without checking the app.

---

### TASK-PLAN.5: Wire FinancePlanView into Finance Tab
Priority: P2
Owner: coder
Status: READY
Lane: safe_auto

**Objective:** Replace the "Financial planning coming soon" placeholder with the actual FinancePlanningView content in the Finance tab's "Plan" segment.

**Files to Touch:**
- `ios/Nexus/Views/Finance/FinanceView.swift` (lines 37-42)
- `ios/Nexus/Views/Finance/FinanceFlatView.swift` (line 35-36)

**Verification:**
- [ ] Open Finance tab → tap "Plan" segment
- [ ] Shows Categories/Recurring/Rules/Settings picker (not "coming soon" text)
- [ ] All 4 sections load and display correctly

**Exit Criteria:**
- [ ] `grep -c 'coming soon' ios/Nexus/Views/Finance/FinanceView.swift` returns 0
- [ ] `grep -c 'FinancePlanningView\|FinancePlanContent' ios/Nexus/Views/Finance/FinanceView.swift` returns ≥1
- [ ] `xcodebuild -scheme Nexus build` succeeds

**Done Means:** Finance "Plan" tab shows actual planning UI instead of placeholder.

---

## Planning Rationale

### Why These Tasks Were Chosen

1. **TASK-PLAN.1 (Offline Indicator)** — High user value, low effort. Currently users have no visibility into whether their data is queued for sync. This causes confusion when network is spotty. Quick win from SUGG-14.

2. **TASK-PLAN.2 (Quick Actions)** — High user value, low effort. Builds on the Siri Shortcuts work (FEAT.11) but adds home screen convenience. iOS users expect 3D Touch quick actions. Quick win from SUGG-12.

3. **TASK-PLAN.3 (GitHub Sync)** — Critical data gap fix. The workflow has been inactive since Jan 27 (10 days of missing GitHub activity). This is a config-only change but marked `needs_approval` because it affects external API calls.

4. **TASK-PLAN.4 (Budget Alerts)** — Medium effort, high engagement value. Proactive notifications drive user retention. The budget logic already exists in `dashboard.get_payload()` — just needs to trigger a notification when threshold crossed.

5. **TASK-PLAN.5 (FinancePlanView)** — Quick polish. The view already exists (`FinancePlanningView.swift` is 27KB), but it's wired as a sheet from the gear button instead of inline in the tab. This unblocks the TODO on line 37.

### What Was Deliberately Excluded

- **Finance stub methods (debt, wishlist, cashflow)** — These require backend API endpoints that don't exist yet. Would be a multi-session effort.
- **HealthKit Medications full implementation** — Blocked on Apple's undocumented `HKMedicationDoseEventQueryDescriptor` API (iOS 18+).
- **Receipt→Nutrition matching (SUGG-06)** — High effort, requires ML/fuzzy matching research. Not a quick win.
- **Unit tests (SUGG-21)** — Blocked on Xcode target setup (requires user action).
- **Inactive n8n workflows (power-metrics, environment-metrics)** — These are intentionally disabled (IoT sensors not connected). Only GitHub sync is accidentally inactive.

### Task Ordering

1. **PLAN.1 + PLAN.2** are quick iOS-only wins with no backend changes
2. **PLAN.3** fixes a data gap that's been accumulating for 10 days
3. **PLAN.4 + PLAN.5** build on existing infrastructure with medium effort
